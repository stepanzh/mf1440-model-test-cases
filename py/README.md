- Степан З.
- 2026-01-19

# Описание решения

> Степан, добрый день! Возвращаюсь к вам с тестовым заданием 
> На выполнение даётся одна неделя, python или matlab 
>
> От руководителя:
> Пример в репозитории (https://github.com/MF1440/model-test-cases) показывает, как инициализировать орбитальную группировку и вычислять траектории космических аппаратов (КА), входящих в её состав. Реализуйте вычислительную процедуру, позволяющую назначать разные частоты соседним КА в группировке (для уменьшения интерференции сигнала).
> Соседними считаются КА, зоны обслуживания которых имеют общую границу.
> Зоны обслуживания на поверхности Земли получаются с помощью разбиения Вороного для подспутниковых точек КА в каждый момент времени.
> Предложите способ, позволяющий рационально минимизировать количество переключений частот на КА системы. 
> Частоты на все КА назначаются из некоторого наперед заданного набора несущих частот.
> При каком минимальном размере этого набора,  переключения частоты на любом КА группировки будут происходить не чаще чем один раз за виток

Я выделил три части

1. Реализуйте вычислительную процедуру, позволяющую назначать разные частоты соседним КА в группировке (для уменьшения интерференции сигнала).
   Соседними считаются КА, зоны обслуживания которых имеют общую границу.
2. Предложите способ, позволяющий рационально минимизировать количество переключений частот на КА системы.
3. При каком минимальном размере этого набора (частот), переключения частоты на любом КА группировки будут происходить не чаще чем один раз за виток.

Плюс условия

- Зоны обслуживания на поверхности Земли получаются с помощью разбиения Вороного для подспутниковых точек КА в каждый момент времени.
- Частоты на все КА назначаются из некоторого наперед заданного набора несущих частот.

## Общее

- Делал 3 дня
- В репозитории обнаружилось, что код как будто специально плохо написан
- Две итерации code review для `constellation.py`
  - `constellation.py` и `example.py` - review
  - `example-87-912.txt` - бэкап на время ревизии
- Мелочи
  - `.gitignore`
  - `requirements.txt`
- Основные файлы
  - `task.py` - задание 1, пример в `if __name__ == '__main__'`
  - `task-figs.py` - задание 1, строит картинки
  - `figs/` сами картинки
  - `notebooks/` - черновики по ресерчу того, что происходит

Для установки

```console
➜  py git:(master) python3 -m venv venv
➜  py git:(master) source venv/bin/activate
(venv) ➜  py git:(master) python3 -m pip install -r requirements.txt

(venv) ➜  py git:(master) chmod +x example.py
(venv) ➜  py git:(master) ./example.py
miss parameter(s)

usage:    ./example.py satellite-index epoch-index
example:  ./example.py 87 912

(venv) ➜  py git:(master) diff <(./example.py 87 912) <(cat example-87-912.txt)
```

## Задание 1

```
(venv) ➜  py git:(master) chmod +x task.py task-figs.py
(venv) ➜  py git:(master) ./task.py
(venv) ➜  py git:(master) ./task-figs.py
```

Пример в `if __name__: ...` назначает спутникам в заданный момент времени (`epochIdx`) частоты из пула частот так, чтобы два соседя работали на разных частотах.

Кратко, алгоритм такой

1. Использую `Constellation`, чтобы получить координаты спутников $p$ в космосе (как в `example.py`).
2. Проецирую координаты на поверхность Земли -> $p'$ (для заданного момента времени).
   Это подспутниковые точки.
   В коде я их упоминаю как `shadow`.
3. Использую разбиение Вороного (`scipy.spatial.SphericalVoronoi`) для подспутниковых точек.
4. Из разбиения извлекаю граф (`networkx.Graph`): пара точек является соседями, если у них общие две вершины из разбиения Вороного.
5. Крашу (`gcol.node_k_coloring`) граф, размер палитры это размер пула частот.
6. Сопостовляю раскраске сами частоты.

### Пример запуска

Выдаёт частоты для первых 20 спутников (из 2000).

```console
(venv) ➜  py git:(master) ✗ ./task.py
Загружена группировка Starlink
2026-01-19 14:48:14 - root - INFO - frequencies of first 20 satellites
satIdx freqIdx  freq
     0       5  16.000000
     1       0  11.000000
     2       2  13.000000
     3       5  16.000000
     4       3  14.000000
     5       0  11.000000
     6       5  16.000000
     7       2  13.000000
     8       2  13.000000
     9       3  14.000000
    10       4  15.000000
    11       2  13.000000
    12       0  11.000000
    13       4  15.000000
    14       4  15.000000
    15       2  13.000000
    16       5  16.000000
    17       4  15.000000
    18       3  14.000000
    19       4  15.000000
```

Можно ещё посмотреть на картинки (итоговая это `04-*.png`).

```console
(venv) ➜  py git:(master) ✗ ./task-figs.py
Загружена группировка Starlink
/Users/stepanzh/Desktop/mf1440-model-test-cases/py/./task-figs.py:52: UserWarning: No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
  ax.legend()

(venv) ➜  py git:(master) ✗ open figs/04-voronoi-non-overlapped.png
```

(На картинке часть подспутниковых точек скрыта.)


## Задания 2 и 3

> Предложите способ, позволяющий рационально минимизировать количество переключений частот на КА системы.
> При каком минимальном размере этого набора (частот), переключения частоты на любом КА группировки будут происходить не чаще чем один раз за виток.

Не успел сделать эти задания, есть только мысли.

Мысли

- Появление соседа с твоим цветом -> переключение
- Пока не рассматривать орбиты с петлями на поверхности Земли, только эллипсы
- Кубик Рубика
- Только одна орбита -> нет переключений
- Спутники из "параллельных" теней орбит -> может возникнуть из-за разности орбитальных скоростей
  - Если скорости одинаковые, то переключений нет
- Виток орбиты и "виток" всей системы -> период перехода разбиения Воровоного самого в себя
- Брутфорс долго?
- Сколько макс. число соседей?
- Теорема о 4 красках
- Планарность
